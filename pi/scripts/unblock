#!/bin/bash

# Script to remove UFW rules for a specific IP address
# Usage: ./unblock_ip.sh <IP_ADDRESS>

if [ $# -ne 1 ]; then
    echo "Usage: $0 <IP_ADDRESS>"
    exit 1
fi

IP_ADDRESS=$1

# Validate IP address format
if ! [[ $IP_ADDRESS =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then
    echo "Error: Invalid IP address format"
    exit 1
fi

echo "Removing rules for IP: $IP_ADDRESS"

# Delete incoming deny rules
sudo ufw delete deny from $IP_ADDRESS 2>/dev/null || true

# Delete outgoing deny rules  
sudo ufw delete deny out from any to $IP_ADDRESS 2>/dev/null || true

